var ea;!function(t){"use strict";function e(t){function e(){k.select(".x.axis.top").call(b.orient("top")),k.select(".x.axis.bottom").call(T.orient("bottom")),I.select(".x.axis.context.bottom").call(y.orient("bottom")),I.select(".x.brush").call(g.extent(l))}function n(t){var e=d3.selectAll(".running");e.empty()||e.transition().duration(c).delay(0).style("opacity","0.9"==e.style("opacity")?".1":"0.9")}var a=t.element,r=t.data,s=2,o=35,i=40,c=1e3,l=[d3.time.hour.offset(new Date,-24),d3.time.hour.offset(new Date,0)],u=[d3.time.day.offset(new Date,-5),new Date],m={top:30,right:20,bottom:30,left:100},f=parseInt(a.style("width"),10)-m.left-m.right;f||(f=100);var d=200,p=100,x=(d3.format("%"),d3.time.scale().clamp(!0).domain(l).range([0,f])),h=d3.time.scale().clamp(!0).domain(u).range([0,f]),g=d3.svg.brush().x(h).extent(l).on("brush",function(){if(!g.empty()){var t=g.extent(),e=new Date;t[1]>e&&(t[1]=e),l=t,x.domain(t),V()}}),v=d3.scale.ordinal(),w=d3.svg.axis(),b=d3.svg.axis().scale(x),T=d3.svg.axis().scale(x).ticks(d3.time.hours,8),y=d3.svg.axis().scale(h),A=a.append("svg").style("width",f+m.left+m.right+"px"),k=A.append("g").attr("class","focus").attr("transform","translate("+[m.left,m.top]+")");k.append("g").attr("class","x axis top"),k.append("g").attr("class","x axis bottom").attr("transform","translate(0,"+d+")"),k.append("g").attr("class","y axis").attr("transform","translate("+-1*s+","+s+")");var D=function(t){var e=+("e"===t),n=e?1:-1,a=p/3;return"M"+.5*n+","+a+"A6,6 0 0 "+e+" "+6.5*n+","+(a+6)+"V"+(2*a-6)+"A6,6 0 0 "+e+" "+.5*n+","+2*a+"ZM"+2.5*n+","+(a+8)+"V"+(2*a-8)+"M"+4.5*n+","+(a+8)+"V"+(2*a-8)},I=A.append("g").attr("class","context").attr("transform","translate("+[m.left,0]+")");I.append("g").attr("class","x axis context bottom").attr("transform","translate(0,"+d+")"),I.append("g").attr("class","x brush").call(g).selectAll("rect").attr("y",-6).attr("height",p+5),I.select(".resize.e").append("path").attr("d",D),I.select(".resize.w").append("path").attr("d",D);var z=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){var e='<strong class="value">'+t.name+"</span><br> <span>"+moment(t.startTime).format("h:mm:ss a")+" &ndash; "+moment(t.endTime).format("h:mm:ss a")+"<br> ("+moment.duration(moment(t.endTime).diff(t.startTime)).format("d[d] h [hrs], m [min], s [sec]")+")</span>";return e});k.call(z);var M=function(t,e){var n=0;return t.endTime?t.startTime&&(n=e(t.endTime)-e(t.startTime)):n=e(new Date)-e(t.startTime),n>0&&1>n&&(n=1),n},B=function(t){var e,n=t;v.domain(n.map(function(t){return t.key})).rangeBands([0,n.length*i]),w.scale(v),k.select(".y.axis").call(w.orient("left")),e=v.rangeExtent()[1],d3.select(k.node().parentNode).style("height",e+m.top+o+p+m.bottom+"px"),A.select(".context").attr("transform",function(){return"translate("+[m.left,e+m.top+o]+")"}),k.select(".x.axis.bottom").attr("transform",function(){return"translate(0,"+(e+2*s)+")"}),I.select(".x.axis.context.bottom").attr("transform",function(){return"translate(0,"+p+")"});var a=k.selectAll(".bar").data(n,function(t){return t.key});a.enter().append("g").attr("class","bar").append("rect").attr("class","background").attr("height",v.rangeBand()),a.attr("transform",function(t,e){var a=d3.map(n,function(t){return t.key}).keys().indexOf(t.key);return"translate(0,"+(a*i+s)+")"});var r=a.selectAll("rect.function").data(function(t){return t.values?t.values:[]});r.enter().append("rect").on("mouseover",z.show).on("mouseout",z.hide).on("contextmenu",d3.contextMenu(function(t){var e=[];return t.docLink&&e.push({title:'<core-icon icon="help" self-center></core-icon>Documentation',action:function(t,e,n){console.log("Item #1 clicked!"),window.location.href=e.docLink}}),e})),r.attr("transform",function(t){return"translate("+x(t.startTime)+",0)"}).attr("class",function(t){var e="function";return t.endTime||(e+=" running"),t.status&&(e+=" status"+t.status),e}).attr("height",v.rangeBand()).attr("width",function(t){return M(t,x)}),r.exit().remove(),a.exit().remove();var c=I.selectAll(".bar").data(n,function(t){return t.key});c.enter().insert("g",":first-child").attr("class","bar"),c.attr("transform",function(t,e){var a=p/n.length;return"translate(0,"+e*a+")"});var l=c.selectAll("rect.function").data(function(t){return t.values?t.values:[]});l.enter().append("rect"),l.attr("transform",function(t){return"translate("+h(t.startTime)+",0)"}).attr("class",function(t){var e="function";return t.endTime||(e+=" running"),t.status&&(e+=" status"+t.status),e}).attr("height",p/n.length).attr("width",function(t){return M(t,h)}),c.exit().remove(),l.exit().remove()};B(r);var V=function(){var t=(new Date).getTime()-u[1].getTime();l[0]=new Date(l[0].getTime()+t),l[1]=new Date(l[1].getTime()+t),u[0]=new Date(u[0].getTime()+t),u[1]=new Date(u[1].getTime()+t),x.domain(l),h.domain(u),k.selectAll("rect.function").attr("transform",function(t){return"translate("+x(t.startTime)+",0)"}).attr("width",function(t){return M(t,x)}),I.selectAll("rect.function").attr("transform",function(t){return"translate("+h(t.startTime)+",0)"}).attr("width",function(t){return M(t,h)}),e()};e();var L=function(){f=parseInt(a.style("width"),10),f=f-m.left-m.right,x.range([0,f]),h.range([0,f]),d3.select(k.node().parentNode).style("width",f+m.left+m.right+"px"),k.selectAll("rect.background").attr("width",f),k.selectAll("rect.function").attr("transform",function(t){return"translate("+x(t.startTime)+",0)"}).attr("width",function(t){return M(t,x)}),I.selectAll("rect.function").attr("transform",function(t){return"translate("+h(t.startTime)+",0)"}).attr("width",function(t){return M(t,h)}),k.select(".x.axis.top").call(b.orient("top")),k.select(".x.axis.bottom").call(T.orient("bottom")),I.select(".x.axis.context.bottom").call(y.orient("bottom")),I.select(".x.brush").call(g.extent(l))};window.setInterval(function(){V()},1e3),window.setInterval(function(){n(c)},c);return Object.freeze({resize:L,update:B})}t.timeline=e}(ea||(ea={}));